from sklearn.svm import OneClassSVM


# One-Class SVMでのマルウェアファミリ異常検知
def anomaly_detection_model(model, features_model, data_loaders):
    train_features = features_model.extract_features(data_loaders['train'])

    print(train_features)
    print(train_features.shape)

    OC_SVM = OneClassSVM(nu=0.1, kernel="rbf", gamma=0.00025)

    print("anomaly detection - train phase")
    print('-' * 10)

    model.fit(train_features)


'''
def ocsvm_evaluate(nu, gamma):

    OC_SVM = OneClassSVM(nu=nu, kernel="rbf", gamma=gamma)
    OC_SVM.fit(train_features)

    pred = OC_SVM.predict(X_test)
    score = accuracy_score(y_test, pred)
    return score
'''