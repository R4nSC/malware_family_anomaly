from sklearn.svm import OneClassSVM

from extract_features import *


# One-Class SVMでのマルウェアファミリ異常検知
def anomaly_detection_model(features_model, data_loaders):
    train_features = features_model.extract_features(data_loaders['train'])

    print(train_features)
    print(train_features.shape)

    OC_SVM = OneClassSVM(nu=0.01, kernel="rbf", gamma=0.00025)

    print("OCSVM train phase")
    print('-' * 10)

    OC_SVM.fit(train_features)

    return OC_SVM
