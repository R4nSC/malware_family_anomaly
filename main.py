import torch

from preprocessing import data_preprocessing
from embedding_model import embedding_model
from test import classification_test
from visualization import train_visualization
from config import *

if __name__ == '__main__':
    # GPUを学習に利用可能かどうか
    use_gpu = torch.cuda.is_available()
    if use_gpu:
        print('Use GPU')
    else:
        print('Do not use GPU')

    data_loaders, datasets_size, class_names = data_preprocessing()

    model_ft, loss, acc = embedding_model(data_loaders, datasets_size, use_gpu)

    classification_test(model_ft, data_loaders, datasets_size, use_gpu)

    # train_visualization(loss, acc, EMBEDDING_EPOCH)
